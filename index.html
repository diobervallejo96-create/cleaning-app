<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aplicación de Compañía de Limpieza</title>
    <!-- Manifest for PWA -->
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <meta name="theme-color" content="#3b82f6" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #f5f7fa;
      }

      header {
        background: #3b82f6;
        color: #ffffff;
        padding: 1rem 2rem;
        text-align: center;
      }

      main {
        margin: 0 auto;
        max-width: 900px;
        padding: 2rem;
      }

      section {
        margin-bottom: 2rem;
        padding: 1rem;
        background: #ffffff;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      h2 {
        margin-top: 0;
      }

      label {
        display: block;
        margin-top: 0.5rem;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 0.5rem;
        margin-top: 0.25rem;
        border: 1px solid #ccc;
        border-radius: 4px;
      }

      button {
        margin-top: 1rem;
        padding: 0.5rem 1rem;
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      button:hover {
        background: #2563eb;
      }

      .hidden {
        display: none;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
      }
      th,
      td {
        padding: 0.5rem;
        border: 1px solid #ddd;
        text-align: left;
      }
      th {
        background: #e5e7eb;
      }
    </style>
  </head>
  <body>
    <header>
      <img src="banner.png" alt="Aplicación de Compañía de Limpieza" style="width: 100%; max-height: 220px; object-fit: cover; border-bottom: 2px solid #e5e7eb;" />
      <h1 style="margin: 1rem 0; color: #3b82f6; text-align: center;">Aplicación de Compañía de Limpieza</h1>
    </header>
    <main>
      <!-- Login/Registro -->
      <section id="authSection">
        <h2>Acceso / Registro</h2>
        <div id="loginForm">
          <h3>Iniciar sesión</h3>
          <label for="loginUsername">Usuario:</label>
          <input type="text" id="loginUsername" />
          <label for="loginPassword">Contraseña:</label>
          <input type="password" id="loginPassword" />
          <button id="loginBtn">Iniciar sesión</button>
          <p>
            ¿No tienes cuenta?
            <a href="#" onclick="showRegister()">Registrarse</a>
          </p>
        </div>
        <div id="registerForm" class="hidden">
          <h3>Registro</h3>
          <label for="regUsername">Usuario:</label>
          <input type="text" id="regUsername" />
          <label for="regPassword">Contraseña:</label>
          <input type="password" id="regPassword" />
          <label for="regRole">Rol:</label>
          <select id="regRole">
            <option value="customer">Cliente</option>
            <option value="cleaner">Proveedor</option>
          </select>
          <!-- Campos extra para proveedores -->
          <div id="providerExtraFields" class="hidden" style="margin-top: 1rem;">
            <label for="regCompanyName">Nombre de la compañía:</label>
            <input type="text" id="regCompanyName" />
            <label for="regPhotoURL">URL de foto o logo:</label>
            <input type="text" id="regPhotoURL" />
            <label for="regPhone">Teléfono de contacto:</label>
            <input type="text" id="regPhone" />
            <label for="regAbout">Descripción de la compañía:</label>
            <textarea id="regAbout" rows="3"></textarea>
          </div>
          <button id="registerBtn">Registrarse</button>
          <p>
            ¿Ya tienes cuenta?
            <a href="#" onclick="showLogin()">Iniciar sesión</a>
          </p>
        </div>
      </section>

      <!-- Sección para clientes -->
      <section id="customerSection" class="hidden">
        <h2>Bienvenido, <span id="customerName"></span></h2>
        <p id="customerReferralInfo" style="font-weight: bold;"></p>
        <p id="customerDiscountInfo" class="hidden" style="color: green;"></p>
        <h3>Reservar servicio</h3>
        <label for="serviceSelect">Servicio:</label>
        <select id="serviceSelect"></select>
        <label for="bookingDate">Fecha:</label>
        <input type="date" id="bookingDate" />
        <label for="bookingTime">Hora:</label>
        <input type="time" id="bookingTime" />
        <!-- Precio que el cliente desea pagar por el servicio -->
        <label for="customerPrice">¿Cuánto estás dispuesto a pagar? ($):</label>
        <input type="number" id="customerPrice" min="1" step="0.01" />
        <!-- Detalles de la casa: habitaciones, baños, salas, cocinas y otros -->
        <label>Detalles de la casa:</label>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.5rem;">
          <div>
            <label for="houseRooms">Habitaciones:</label>
            <input type="number" id="houseRooms" min="0" value="0" />
          </div>
          <div>
            <label for="houseBathrooms">Baños:</label>
            <input type="number" id="houseBathrooms" min="0" value="0" />
          </div>
          <div>
            <label for="houseLivingRooms">Salas de estar:</label>
            <input type="number" id="houseLivingRooms" min="0" value="0" />
          </div>
          <div>
            <label for="houseKitchens">Cocinas:</label>
            <input type="number" id="houseKitchens" min="0" value="0" />
          </div>
        </div>
        <label for="houseOther">Otros detalles (opcional):</label>
        <textarea id="houseOther" rows="2"></textarea>
        <label for="referralInput">Código de referido (opcional):</label>
        <input type="text" id="referralInput" />
        <button id="bookBtn">Reservar</button>
        <h3>Mis reservaciones</h3>
        <table id="customerBookings">
          <thead>
            <tr>
              <th>Servicio</th>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Estado</th>
              <th>Proveedor</th>
              <th>Precio (final)</th>
              <th>Precio cliente</th>
              <th>Precio proveedor</th>
              <th>Pago</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- Sección para proveedores -->
      <section id="cleanerSection" class="hidden">
        <h2>Panel de Proveedor</h2>
        <h3>Reservaciones asignadas</h3>
        <table id="cleanerBookings">
          <thead>
            <tr>
              <th>Cliente</th>
              <th>Servicio</th>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Precio cliente</th>
              <th>Detalles casa</th>
              <th>Precio proveedor</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <!-- Información de perfil del proveedor y enlace para compartir -->
        <h3>Mi perfil</h3>
        <div id="providerInfo" style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;"></div>
        <button id="editProfileBtn">Editar perfil</button>
        <div id="editProfileForm" class="hidden" style="margin-top: 1rem;">
          <label for="providerCompanyName">Nombre de la compañía:</label>
          <input type="text" id="providerCompanyName" />
          <label for="providerPhotoURL">URL de foto o logo:</label>
          <input type="text" id="providerPhotoURL" />
          <label for="providerPhone">Teléfono:</label>
          <input type="text" id="providerPhone" />
          <label for="providerAbout">Descripción:</label>
          <textarea id="providerAbout" rows="3"></textarea>
          <button id="saveProfileBtn">Guardar perfil</button>
        </div>
        <h3>Enlace para mis clientes</h3>
        <p>Comparte este enlace para que tus clientes programen una cita contigo:</p>
        <input type="text" id="providerLink" readonly style="width: 100%;" />
      </section>

      <!-- Sección para administrador -->
      <section id="adminSection" class="hidden">
        <h2>Panel de Administración</h2>
        <h3>Reservaciones</h3>
        <table id="adminBookings">
          <thead>
            <tr>
              <th>ID</th>
              <th>Cliente</th>
              <th>Servicio</th>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Proveedor</th>
              <th>Estado</th>
              <th>Precio (final)</th>
              <th>Precio cliente</th>
              <th>Precio proveedor</th>
              <th>Pago</th>
              <th>Asignar proveedor</th>
              <th>Acción de pago</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <h3>Enlace de reserva para clientes</h3>
        <p>Comparte este enlace con tus clientes para que programen sus citas:</p>
        <input type="text" id="bookingLink" readonly style="width: 100%;" />
      </section>
    </main>
    <script src="script.js"></script>
    <!-- Registro del service worker para PWA -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function () {
          navigator.serviceWorker.register('service-worker.js').catch(function (error) {
            console.error('Fallo al registrar el service worker:', error);
          });
        });
      }
    </script>
  </body>
</html>